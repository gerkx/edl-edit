{"version":3,"sources":["javascript/app.js"],"names":["startTime","fps","dropArea","document","querySelector","manualFile","getElementById","link","dropped","addEventListener","e","preventDefault","stopPropagation","classList","add","remove","file","dataTransfer","files","fileChecker","srcElement","fileSplit","name","split","ext","length","alert","fileName","read","FileReader","onload","content","result","map","line","idx","arr","offsetSourceClipTC","reduce","accum","val","download","readAsText","tcToFrames","str","units","num","parseInt","frames","framesToTC","sec","Math","floor","fr","min","hour","padZero","tcLine","lineArr","origStartFrame","origEndFrame","newStartFrame","frameOffset","newEndTime","zeros","toString","text","filename","element","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","updateButton","fileBtn","innerHTML"],"mappings":"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","file":"app.26584510.map","sourceRoot":"..","sourcesContent":["// const util = require('./utils/util');\n// const fileIn = require('./components/file-in');\n\nconst startTime = \"00:00:00:00\";\nconst fps = 25;\nconst dropArea = document.querySelector('.edl__file-zone');\nconst manualFile = document.getElementById('file-in');\nconst link = document.getElementById(\"file\");\nlet dropped = 0;\n\ndropArea.addEventListener(\"dragover\", e => {\n  e.preventDefault();\n  e.stopPropagation();\n  dropArea.classList.add('edl__file-zone--active');\n});\n\ndropArea.addEventListener(\"dragleave\", e => {\n  e.preventDefault();\n  e.stopPropagation();\n  dropArea.classList.remove('edl__file-zone--active');\n  // dropped = 0;\n});\n\ndropArea.addEventListener(\"drop\", e => {\n  e.preventDefault();\n  e.stopPropagation();\n  dropArea.classList.remove('edl__file-zone--active');\n  const file = e.dataTransfer.files[0];\n  dropped += 1;\n  fileChecker(file);\n  // dropped = 0;\n});\n\nlink.addEventListener(\"change\", e => {\n  e.preventDefault();\n  e.stopPropagation();\n  const file = e.srcElement.files[0];\n  // console.log(link.value)\n\n  // const file = e.dataTransfer.files[0];\n  // console.log(file);\n  dropped += 1;\n  fileChecker(file);\n})\n\n\n\nfunction fileChecker(file) {\n  const fileSplit = file.name.split(\".\");\n  const ext = fileSplit[fileSplit.length-1];\n  if(ext !== \"edl\") {\n    alert(\"Elige un EDL, por favor\")\n  }\n  if(dropped == 1) {\n    // alert(\"file dropped\");\n    let fileName = file.name;\n    let read = new FileReader();\n    read.onload = function() {\n      // updateButton(fileName);\n      const content = read.result.split(\"\\n\")\n      .map((line, idx, arr) => {\n          if(idx > 1 && arr[idx-1].length <= 1)  {\n\n              return offsetSourceClipTC(line)\n          }else{\n              return line\n          } \n      })\n      .reduce((accum, val) => {\n          return accum += val + \"\\n\"\n      }, \"\");\n      const file = `${fileName.split(\".\")[0]}_rev.edl`;\n      download(content, file);\n      dropped = 0;\n    }\n    read.readAsText(file);\n  }\n\n  \n}\n\nfunction tcToFrames (str) {\n  const units = str.split(\":\").map(num => parseInt(num, 10));\n  let frames = (units[0]*3600 + units[1]*60 + units[2])*fps+units[3];\n  return frames\n}\n\nfunction framesToTC (frames) {\n  let sec = Math.floor(frames/25);\n  frames -= sec*fps\n  let fr = frames%25\n  let min = Math.floor(sec/60);\n  sec -= min*60;\n  let hour = Math.floor(min/60);\n  min -= hour*60;\n  return `${padZero(hour, 2)}:${padZero(min,2)}:${padZero(sec,2)}:${padZero(fr,2)}`\n}\n\nfunction offsetSourceClipTC(tcLine) {\n  \n  const lineArr = tcLine.split(/\\s+/);               \n  const origStartFrame = tcToFrames(lineArr[4]);\n  const origEndFrame = tcToFrames(lineArr[5]);\n  const newStartFrame = tcToFrames(startTime);\n  const frameOffset = origStartFrame - newStartFrame;\n  const newEndTime = framesToTC(origEndFrame - frameOffset);\n  return `${lineArr[0]}  ${lineArr[1]}       V  ${lineArr[3]}        ${startTime} ${newEndTime} ${lineArr[6]} ${lineArr[7]}`\n}\n\nfunction padZero(num, zeros) {\n  num = num.toString();\n  while(num.length < zeros){\n      num = \"0\" + num;\n  }\n  return num\n}\n\nfunction download(text, filename) {\n  const element = document.createElement('a');\n  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n  element.setAttribute('download', filename);\n  element.style.display = 'none';\n  document.body.appendChild(element);\n  element.click();\n  document.body.removeChild(element);\n}\n\nfunction updateButton(str) {\n  fileBtn.innerHTML = str;\n}"]}